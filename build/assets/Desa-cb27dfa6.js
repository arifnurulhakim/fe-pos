import{_ as ee,s as ae,r as u,k as le,o as te,E as S,l as se,b as k,c as f,d as b,e as s,f as l,g as d,q as p,t as m,n as V,i as g,p as oe,j as de}from"./index-b7d2a657.js";const i=P=>(oe("data-v-c066a486"),P=P(),de(),P),ie={class:"grid"},ne={class:"col-12"},ue={class:"card"},re={class:"my-2"},ce={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},ve=i(()=>s("h5",{class:"m-0"},"Desa",-1)),pe={class:"block mt-2 md:mt-0 p-input-icon-left"},me=i(()=>s("i",{class:"pi pi-search"},null,-1)),_e=i(()=>s("span",{class:"p-column-title"},"Kode Desa",-1)),ke=i(()=>s("span",{class:"p-column-title"},"Kode Kecamatan",-1)),fe=i(()=>s("span",{class:"p-column-title"},"Kode Kabupaten",-1)),be=i(()=>s("span",{class:"p-column-title"},"Kode Provinsi",-1)),he=i(()=>s("span",{class:"p-column-title"},"Nama Desa",-1)),ye=i(()=>s("span",{class:"p-column-title"},"Nama Kecamatan",-1)),ge=i(()=>s("span",{class:"p-column-title"},"Nama Kabupaten",-1)),De=i(()=>s("span",{class:"p-column-title"},"Nama Provinsi",-1)),we={class:"field"},xe=i(()=>s("label",{for:"kode_desa"},"Kode Desa",-1)),Ce={key:0,class:"p-invalid"},Se={class:"field"},Ve=i(()=>s("label",{for:"kode_kec"},"Kode Kecamatan",-1)),Pe={key:0,class:"p-invalid"},Ke={class:"field"},Ne=i(()=>s("label",{for:"kode_kab"},"Kode Kabupaten",-1)),Ie={key:0,class:"p-invalid"},Te={class:"field"},Ue=i(()=>s("label",{for:"kode_prov"},"Kode Provinsi",-1)),qe={key:0,class:"p-invalid"},Me={class:"field"},Be=i(()=>s("label",{for:"nama_desa"},"Nama Desa",-1)),Fe={key:0,class:"p-invalid"},Le={class:"flex align-items-center justify-content-center"},Ee=i(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),Re={key:0},$e={class:"flex align-items-center justify-content-center"},Ae=i(()=>s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),je={key:0},ze={__name:"Desa",setup(P){const h=ae(),c=u(null),_=u(!1),x=u(!1),C=u(!1),e=u({}),y=u(null),M=u(null),K=u({}),n=u(!1),N=u(10),I=u(1),T=u(0),U=u(!1),F="pi pi-spin pi-spinner";le(()=>{J()}),te(()=>{B()});const B=()=>{U.value=!0,S.get("api/desa",{params:{perPage:N.value,currentPage:I.value}}).then(o=>{o.data.status==="success"&&(c.value=o.data.data,T.value=o.data.total_data)}).catch(o=>{console.error(o),h.add({severity:"error",summary:"Error",detail:"Failed to fetch data",life:3e3})}).finally(()=>{U.value=!1})},L=o=>{I.value=o.page+1,N.value=o.rows,B()},E=()=>{e.value={},n.value=!1,_.value=!0},R=()=>{_.value=!1,n.value=!1},$=async()=>{if(n.value=!0,e.value.kode_desa&&e.value.kode_kec&&e.value.kode_kab&&e.value.kode_prov&&e.value.nama_desa){if(console.log(e.value.id),e.value.id){const o=O(e.value.id);c.value[o]=e.value,await S.put(`/api/desa/${e.value.id}`,{kode_desa:e.value.kode_desa,kode_kec:e.value.kode_kec,kode_prov:e.value.kode_prov,nama_desa:e.value.nama_desa}),h.add({severity:"success",summary:"Successful",detail:"Desa Updated",life:3e3}),_.value=!1,e.value={}}else c.value.push(e.value),await S.post("/api/desa",{kode_desa:e.value.kode_desa,kode_kec:e.value.kode_kec,kode_kab:e.value.kode_kab,kode_prov:e.value.kode_prov,nama_desa:e.value.nama_desa}),h.add({severity:"success",summary:"Successful",detail:"Desa Created",life:3e3}),_.value=!1,e.value={};_.value=!1,e.value={}}},A=o=>{e.value={...o},console.log(e),_.value=!0},j=o=>{e.value=o,x.value=!0},z=async()=>{try{await S.delete(`/api/desa/${e.value.id}`),c.value=c.value.filter(o=>o.id!==e.value.id),x.value=!1,e.value={},h.add({severity:"success",summary:"Successful",detail:"Desa Deleted",life:3e3})}catch(o){console.error(o),h.add({severity:"error",summary:"Error",detail:"An error occurred",life:3e3})}},O=o=>{let t=-1;for(let D=0;D<c.value.length;D++)if(c.value[D].id===o){t=D;break}return t},Y=()=>{M.value.exportCSV()},G=()=>{C.value=!0},H=async()=>{try{const o=y.value.map(t=>t.id);await S.delete("/api/desa",{data:{ids:o}}),c.value=c.value.filter(t=>!y.value.includes(t)),C.value=!1,y.value=null,h.add({severity:"success",summary:"Successful",detail:"Desas Deleted",life:3e3})}catch(o){console.error(o),h.add({severity:"error",summary:"Error",detail:"An error occurred",life:3e3})}},J=()=>{K.value={global:{value:null,matchMode:se.CONTAINS}}};return(o,t)=>{const D=k("Toast"),r=k("Button"),Q=k("FileUpload"),W=k("Toolbar"),w=k("InputText"),v=k("Column"),X=k("DataTable"),q=k("Dialog");return f(),b("div",ie,[s("div",ne,[s("div",ue,[l(D),l(W,{class:"mb-4"},{start:d(()=>[s("div",re,[l(r,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:E}),l(r,{label:"Delete",icon:"pi pi-trash",class:"p-button-danger",onClick:G,disabled:!y.value||!y.value.length},null,8,["disabled"])])]),end:d(()=>[l(Q,{mode:"basic",accept:"image/*",maxFileSize:1e6,label:"Import",chooseLabel:"Import",class:"mr-2 inline-block"}),l(r,{label:"Export",icon:"pi pi-upload",class:"p-button-help",onClick:t[0]||(t[0]=a=>Y(a))})]),_:1}),l(X,{ref_key:"dt",ref:M,value:c.value,selection:y.value,"onUpdate:selection":t[2]||(t[2]=a=>y.value=a),dataKey:"id",paginator:!0,rows:N.value,currentPage:I.value,filters:K.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],totalRecords:T.value,loading:U.value,currentPageReportTemplate:"Showing {first} to {last} of "+T.value+" provinsis",loadingIcon:F,onPage:L},{header:d(()=>[s("div",ce,[ve,s("span",pe,[me,l(w,{modelValue:K.value.global.value,"onUpdate:modelValue":t[1]||(t[1]=a=>K.value.global.value=a),placeholder:"Search..."},null,8,["modelValue"])])])]),default:d(()=>[l(v,{selectionMode:"multiple",headerStyle:"width: 3rem"}),l(v,{field:"kode_desa",header:"kode desa",sortable:!0,headerStyle:"width:40%; min-width:10rem;"},{body:d(a=>[_e,p(" "+m(a.data.kode_desa),1)]),_:1}),l(v,{field:"kode_kec",header:"kode kecamatan",sortable:!0,headerStyle:"width:40%; min-width:10rem;"},{body:d(a=>[ke,p(" "+m(a.data.kode_kec),1)]),_:1}),l(v,{field:"kode_kab",header:"kode kabupaten",sortable:!0,headerStyle:"width:40%; min-width:10rem;"},{body:d(a=>[fe,p(" "+m(a.data.kode_kab),1)]),_:1}),l(v,{field:"kode_prov",header:"kode provinsi",sortable:!0,headerStyle:"width:40%; min-width:10rem;"},{body:d(a=>[be,p(" "+m(a.data.kode_prov),1)]),_:1}),l(v,{field:"nama_desa",header:"nama desa",sortable:!0,headerStyle:"width:40%; min-width:10rem;"},{body:d(a=>[he,p(" "+m(a.data.nama_desa),1)]),_:1}),l(v,{field:"nama_kecamatan",header:"nama kecamatan",sortable:!0,headerStyle:"width:40%; min-width:10rem;"},{body:d(a=>[ye,p(" "+m(a.data.nama_kecamatan),1)]),_:1}),l(v,{field:"nama_kabupaten",header:"nama kabupaten",sortable:!0,headerStyle:"width:10%; min-width:10rem;"},{body:d(a=>[ge,p(" "+m(a.data.nama_kabupaten),1)]),_:1}),l(v,{field:"nama_provinsi",header:"nama provinsi",sortable:!0,headerStyle:"width:10%; min-width:10rem;"},{body:d(a=>[De,p(" "+m(a.data.nama_provinsi),1)]),_:1}),l(v,{headerStyle:"min-width:10rem;"},{body:d(a=>[l(r,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:Z=>A(a.data)},null,8,["onClick"]),l(r,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:Z=>j(a.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","rows","currentPage","filters","totalRecords","loading","currentPageReportTemplate"]),l(q,{visible:_.value,"onUpdate:visible":t[8]||(t[8]=a=>_.value=a),style:{width:"450px"},header:"Desa Details",modal:!0,class:"p-fluid"},{footer:d(()=>[l(r,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:R}),l(r,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:$})]),default:d(()=>[s("div",we,[xe,l(w,{id:"kode_desa    ",modelValue:e.value.kode_desa,"onUpdate:modelValue":t[3]||(t[3]=a=>e.value.kode_desa=a),modelModifiers:{trim:!0},required:"true",autofocus:"",class:V({"p-invalid":n.value&&!e.value.kode_desa})},null,8,["modelValue","class"]),n.value&&!e.value.kode_desa?(f(),b("small",Ce,"Kode is required.")):g("",!0)]),s("div",Se,[Ve,l(w,{id:"kode_kec",modelValue:e.value.kode_kec,"onUpdate:modelValue":t[4]||(t[4]=a=>e.value.kode_kec=a),modelModifiers:{trim:!0},required:"true",autofocus:"",class:V({"p-invalid":n.value&&!e.value.kode_kec})},null,8,["modelValue","class"]),n.value&&!e.value.kode_kec?(f(),b("small",Pe,"Kode is required.")):g("",!0)]),s("div",Ke,[Ne,l(w,{id:"kode_kab",modelValue:e.value.kode_kab,"onUpdate:modelValue":t[5]||(t[5]=a=>e.value.kode_kab=a),modelModifiers:{trim:!0},required:"true",autofocus:"",class:V({"p-invalid":n.value&&!e.value.kode_kab})},null,8,["modelValue","class"]),n.value&&!e.value.kode_kab?(f(),b("small",Ie,"Kode Desa is required.")):g("",!0)]),s("div",Te,[Ue,l(w,{id:"kode_prov",modelValue:e.value.kode_prov,"onUpdate:modelValue":t[6]||(t[6]=a=>e.value.kode_prov=a),modelModifiers:{trim:!0},required:"true",autofocus:"",class:V({"p-invalid":n.value&&!e.value.kode_prov})},null,8,["modelValue","class"]),n.value&&!e.value.kode_prov?(f(),b("small",qe,"Kode Desa is required.")):g("",!0)]),s("div",Me,[Be,l(w,{id:"nama_desa",modelValue:e.value.nama_desa,"onUpdate:modelValue":t[7]||(t[7]=a=>e.value.nama_desa=a),modelModifiers:{trim:!0},required:"true",autofocus:"",class:V({"p-invalid":n.value&&!e.value.nama_desa})},null,8,["modelValue","class"]),n.value&&!e.value.nama_desa?(f(),b("small",Fe,"Nama Desa is required.")):g("",!0)])]),_:1},8,["visible"]),l(q,{visible:x.value,"onUpdate:visible":t[10]||(t[10]=a=>x.value=a),style:{width:"450px"},header:"Confirm",modal:!0},{footer:d(()=>[l(r,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[9]||(t[9]=a=>x.value=!1)}),l(r,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:z})]),default:d(()=>[s("div",Le,[Ee,e.value?(f(),b("span",Re,[p("Are you sure you want to delete "),s("b",null,m(e.value.name),1),p("?")])):g("",!0)])]),_:1},8,["visible"]),l(q,{visible:C.value,"onUpdate:visible":t[12]||(t[12]=a=>C.value=a),style:{width:"450px"},header:"Confirm",modal:!0},{footer:d(()=>[l(r,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:t[11]||(t[11]=a=>C.value=!1)}),l(r,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:H})]),default:d(()=>[s("div",$e,[Ae,e.value?(f(),b("span",je,"Are you sure you want to delete the selected desas?")):g("",!0)])]),_:1},8,["visible"])])])])}}},Ye=ee(ze,[["__scopeId","data-v-c066a486"]]);export{Ye as default};
